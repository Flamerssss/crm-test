(self.webpackChunk_N_E = self.webpackChunk_N_E || []).push([[7003], { 45416: function (e, n, t) { (window.__NEXT_P = window.__NEXT_P || []).push(["/cars/profile/damage/DamageMapDialog", function () { return t(65003) }]) }, 65003: function (e, n, t) { "use strict"; t.r(n), t.d(n, { default: function () { return O } }); var r = t(34051), a = t.n(r), i = t(85893), o = t(67294), l = t(1902), c = (t(96621), t(77058)), u = t(64666), s = t(33090), d = t(15861), f = t(31425), m = t(83321), h = t(6514), g = t(86886), v = t(87357), p = t(50135), y = t(72890), _ = t(50480), x = t(36872), j = t(18972); function b(e, n) { (null == n || n > e.length) && (n = e.length); for (var t = 0, r = new Array(n); t < n; t++)r[t] = e[t]; return r } function w(e, n, t, r, a, i, o) { try { var l = e[i](o), c = l.value } catch (u) { return void t(u) } l.done ? n(c) : Promise.resolve(c).then(r, a) } function Z(e, n, t) { return n in e ? Object.defineProperty(e, n, { value: t, enumerable: !0, configurable: !0, writable: !0 }) : e[n] = t, e } function P(e) { for (var n = 1; n < arguments.length; n++) { var t = null != arguments[n] ? arguments[n] : {}, r = Object.keys(t); "function" === typeof Object.getOwnPropertySymbols && (r = r.concat(Object.getOwnPropertySymbols(t).filter((function (e) { return Object.getOwnPropertyDescriptor(t, e).enumerable })))), r.forEach((function (n) { Z(e, n, t[n]) })) } return e } function S(e, n) { return function (e) { if (Array.isArray(e)) return e }(e) || function (e, n) { var t = null == e ? null : "undefined" !== typeof Symbol && e[Symbol.iterator] || e["@@iterator"]; if (null != t) { var r, a, i = [], o = !0, l = !1; try { for (t = t.call(e); !(o = (r = t.next()).done) && (i.push(r.value), !n || i.length !== n); o = !0); } catch (c) { l = !0, a = c } finally { try { o || null == t.return || t.return() } finally { if (l) throw a } } return i } }(e, n) || E(e, n) || function () { throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.") }() } function C(e) { return function (e) { if (Array.isArray(e)) return b(e) }(e) || function (e) { if ("undefined" !== typeof Symbol && null != e[Symbol.iterator] || null != e["@@iterator"]) return Array.from(e) }(e) || E(e) || function () { throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.") }() } function E(e, n) { if (e) { if ("string" === typeof e) return b(e, n); var t = Object.prototype.toString.call(e).slice(8, -1); return "Object" === t && e.constructor && (t = e.constructor.name), "Map" === t || "Set" === t ? Array.from(t) : "Arguments" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? b(e, n) : void 0 } } function O(e) { var n = e.selectedArea, t = e.onClose, r = e.onSave, b = e.damages, Z = e.car, E = e.damageWhere, O = e.companyId, k = e.userId, A = function (e) { D[R] = P({}, D[R], e), T(C(D)) }, I = (0, c.$)().t, W = (0, o.useState)(b), D = W[0], T = W[1], N = o.useRef(null), M = S(o.useState(0), 2), R = M[0], U = M[1], H = D[R], L = [{ title: I("cars_damage_level_low"), value: "Low" }, { title: I("cars_damage_level_middle"), value: "Middle" }, { title: I("cars_damage_level_high"), value: "High" }]; (0, o.useEffect)((function () { T(b) }), [b]); var X = S(o.useState([]), 2), $ = X[0], B = X[1], F = function () { var e, n = (e = a().mark((function e() { return a().wrap((function (e) { for (; ;)switch (e.prev = e.next) { case 0: l.Z.firestore().collection(O).doc("company").collection("clients").onSnapshot((function (e) { var n = []; e.forEach((function (e) { return n.push(e.data()) })), B(n) })); case 2: case "end": return e.stop() } }), e) })), function () { var n = this, t = arguments; return new Promise((function (r, a) { var i = e.apply(n, t); function o(e) { w(i, r, a, o, l, "next", e) } function l(e) { w(i, r, a, o, l, "throw", e) } o(void 0) })) }); return function () { return n.apply(this, arguments) } }(); (0, o.useEffect)((function () { O && F() }), [O]); var V = (0, o.useRef)(null), q = function (e) { console.log("imagePassport1 in handleUploadPassport1", e), l.Z.storage().ref("".concat(O, "/crm/damage/").concat(H.damageWhere, "/").concat(e.name)).put(e).on("state_changed", (function (e) { Math.round(e.bytesTransferred / e.totalBytes * 100) }), (function (e) { console.log(e) }), (function () { l.Z.storage().ref("".concat(O, "/crm/damage/").concat(H.damageWhere, "/")).child(e.name).getDownloadURL().then((function (e) { !function (e) { A(P({}, H, { damage_image: e })) }(e) })) })) }; return (0, i.jsxs)(u.Z, { open: n, onClose: t, "aria-labelledby": "max-width-dialog-title", children: [(0, i.jsx)("div", { style: { display: "flex" }, children: D.map((function (e, n) { return (0, i.jsx)("button", { onClick: function () { return U(n) }, children: n + 1 }, n) })) }), (0, i.jsxs)(s.Z, { id: "max-width-dialog-title", children: [(0, i.jsx)(d.Z, { variant: "h4", children: I("cars_damage_download_photo") }), (0, i.jsxs)(f.Z, { sx: { pr: 2.5 }, children: [(0, i.jsx)("div", { children: (0, i.jsx)(m.Z, { onClick: function () { var e = D.push({ areaId: n, car_id: Z.id, damageWhere: E, isDamage: !0, created_at: new Date, company_id: O, author_user_id: k }); T(C(D)), U(e - 1) }, variant: "contained", color: "error", children: I("cars_damage_add_new") }) }), (0, i.jsx)("div", { children: (0, i.jsx)(m.Z, { onClick: function () { r(D), t() }, variant: "contained", color: "primary", children: I("Save") }) })] })] }), (0, i.jsx)(h.Z, { children: H && (0, i.jsxs)(g.ZP, { container: !0, children: [(0, i.jsx)(g.ZP, { item: !0, xs: 12, md: 12, children: (0, i.jsx)(v.Z, { children: (0, i.jsx)("form", { noValidate: !0, autoComplete: "off", children: (0, i.jsxs)(g.ZP, { container: !0, children: [(0, i.jsx)(g.ZP, { item: !0, xs: 12, md: 12, children: (0, i.jsx)(p.Z, { value: H.damage_type || "", onChange: function (e) { A({ damage_type: e.target.value }) }, fullWidth: !0, label: I("cars_damage_type"), variant: "outlined" }) }), (0, i.jsx)(g.ZP, { item: !0, xs: 12, md: 12, children: (0, i.jsx)(p.Z, { value: H.comment || "", onChange: function (e) { A({ comment: e.target.value }) }, fullWidth: !0, label: I("cars_damage_description"), variant: "outlined" }) }), (0, i.jsx)(g.ZP, { item: !0, xs: 12, children: (0, i.jsx)(v.Z, { title: I("cars_damage_level"), style: { marginTop: 15 }, children: (0, i.jsx)(y.Z, { ref: N, "aria-label": "ringtone", name: "ringtone", value: H.value || "-1", onChange: function (e) { A({ value: e.target.value }) }, children: L.map((function (e) { return (0, i.jsx)(_.Z, { value: e.value, control: (0, i.jsx)(x.Z, {}), label: e.title }, e.value) })) }) }) }), (0, i.jsx)(g.ZP, { item: !0, xs: 12, md: 12, children: (0, i.jsx)(p.Z, { select: !0, fullWidth: !0, label: I("cars_damage_client"), value: H.client || "", onChange: function (e) { var n = $.findIndex((function (n) { return n.client_surname + " " + n.client_name === e.target.value })); -1 !== n && A({ client: e.target.value, client_id: $[n].id }) }, variant: "outlined", children: $.map((function (e) { return (0, i.jsx)(j.Z, { value: e.client_surname + " " + e.client_name, children: e.client_surname + " " + e.client_name }, e.client_name) })) }) })] }) }) }) }), (0, i.jsx)(g.ZP, { item: !0, xs: 12, md: 12, children: (0, i.jsxs)(v.Z, { title: I("cars_damage_photo"), style: { position: "relative" }, children: [(0, i.jsx)("div", { style: { width: "100%", height: "100%" }, onClick: function () { V.current.click() }, children: (0, i.jsx)("img", { alt: "", src: (null === H || void 0 === H ? void 0 : H.damage_image) || "https://www.aluminati.net/wp-content/uploads/2016/03/img-placeholder.png", style: { width: "100%", height: "100%", minHeight: 150, objectFit: "cover" } }) }), (0, i.jsx)("input", { type: "file", onChange: function (e) { return q(e.target.files[0]) }, style: { width: .1, height: .1, opacity: 0, pointerEvents: "none" }, ref: V })] }) })] }) })] }) } } }, function (e) { e.O(0, [9990, 5360, 6827, 3970, 5464, 6668, 2945, 8991, 7104, 8722, 7737, 9774, 2888, 179], (function () { return n = 45416, e(e.s = n); var n })); var n = e.O(); _N_E = n }]);