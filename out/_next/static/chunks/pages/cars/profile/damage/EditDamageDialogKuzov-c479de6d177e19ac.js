(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5749],{52608:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cars/profile/damage/EditDamageDialogKuzov",function(){return t(12908)}])},12908:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return D}});var r=t(34051),a=t.n(r),i=t(85893),o=t(67294),c=t(6585),l=t(64666),u=t(33090),s=t(15861),d=t(31425),f=t(83321),h=t(6514),m=t(86886),g=t(50135),p=t(87357),v=t(72890),y=t(50480),_=t(36872),x=t(18972),j=t(66242),w=t(78445),b=t(44267),Z=t(73400),P=t(77058),C=t(1902);t(96621);function k(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function E(e,n,t,r,a,i,o){try{var c=e[i](o),l=c.value}catch(u){return void t(u)}c.done?n(l):Promise.resolve(l).then(r,a)}function O(e){return function(){var n=this,t=arguments;return new Promise((function(r,a){var i=e.apply(n,t);function o(e){E(i,r,a,o,c,"next",e)}function c(e){E(i,r,a,o,c,"throw",e)}o(void 0)}))}}function S(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function T(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){S(e,n,t[n])}))}return e}function A(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,i=[],o=!0,c=!1;try{for(t=t.call(e);!(o=(r=t.next()).done)&&(i.push(r.value),!n||i.length!==n);o=!0);}catch(l){c=!0,a=l}finally{try{o||null==t.return||t.return()}finally{if(c)throw a}}return i}}(e,n)||function(e,n){if(!e)return;if("string"===typeof e)return k(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return k(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(e){var n=e.open,t=e.onClose,r=e.damagesEdit,k=e.companyId,E=(0,P.$)().t,S=(0,Z.Ds)().enqueueSnackbar,D=o.useRef(null),I=[{title:E("cars_damage_level_low"),value:"Low"},{title:E("cars_damage_level_middle"),value:"Middle"},{title:E("cars_damage_level_high"),value:"High"}],N=A(o.useState([]),2),W=N[0],M=N[1],R=function(){var e=O(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C.Z.firestore().collection(k).doc("company").collection("clients").onSnapshot((function(e){var n=[];e.forEach((function(e){return n.push(e.data())})),M(n)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,o.useEffect)((function(){R()}),[]);var U=(0,o.useRef)(null),z=function(e){console.log("imagePassport1 in handleUploadPassport1",e),C.Z.storage().ref("".concat(k,"/crm/damage/").concat(r.damageWhere,"/").concat(e.name)).put(e).on("state_changed",(function(e){Math.round(e.bytesTransferred/e.totalBytes*100)}),(function(e){console.log(e)}),(function(){C.Z.storage().ref("".concat(k,"/crm/damage/").concat(r.damageWhere,"/")).child(e.name).getDownloadURL().then((function(e){!function(e){L(T({},r,{damage_image:e}))}(e)}))}))};(0,o.useEffect)((function(){return L(r)}),[n]);var B=A(o.useState({damage_type:r.damage_type}),2),H=B[0],L=B[1],X=function(){var e=O(a().mark((function e(n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.Z.firestore().collection(k).doc("company").collection("carDamages").doc(n.id).set(n);case 2:S(E("Saved"),{variant:"success",anchorOrigin:{vertical:"top",horizontal:"right"},TransitionComponent:c.Z}),t();case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,i.jsxs)(l.Z,{open:n,onClose:t,"aria-labelledby":"max-width-dialog-title",children:[(0,i.jsxs)(u.Z,{id:"max-width-dialog-title",children:[(0,i.jsx)(s.Z,{variant:"h4",children:E("cars_damage_download_photo")}),(0,i.jsxs)(d.Z,{sx:{pr:2.5},children:[(0,i.jsx)("div",{children:(0,i.jsx)(f.Z,{onClick:function(){return X(H)},variant:"contained",color:"primary",children:E("Save")})}),(0,i.jsx)("div",{children:(0,i.jsx)(f.Z,{onClick:t,variant:"contained",color:"error",children:E("Back")})})]})]}),(0,i.jsxs)(h.Z,{children:[(0,i.jsxs)(m.ZP,{container:!0,spacing:3,style:{marginTop:10},children:[(0,i.jsx)(m.ZP,{item:!0,xs:12,md:12,children:(0,i.jsx)(g.Z,{value:H.damage_type||"",onChange:function(e){L(T({},H,{damage_type:e.target.value}))},fullWidth:!0,label:E("cars_damage_type"),variant:"outlined"})}),(0,i.jsx)(m.ZP,{item:!0,xs:12,md:12,children:(0,i.jsx)(g.Z,{value:H.comment||"",onChange:function(e){L(T({},H,{comment:e.target.value}))},fullWidth:!0,label:E("cars_damage_description"),variant:"outlined"})}),(0,i.jsx)(m.ZP,{item:!0,xs:12,children:(0,i.jsx)(p.Z,{title:E("cars_damage_level"),style:{marginTop:15},children:(0,i.jsx)(v.Z,{ref:D,"aria-label":"ringtone",name:"ringtone",value:H.value||"-1",onChange:function(e){L(T({},H,{value:e.target.value}))},children:I.map((function(e){return(0,i.jsx)(y.Z,{value:e.value,control:(0,i.jsx)(_.Z,{}),label:e.title},e.value)}))})})}),(0,i.jsx)(m.ZP,{item:!0,xs:12,md:12,children:(0,i.jsx)(g.Z,{select:!0,fullWidth:!0,label:E("cars_damage_client"),value:H.client||"",onChange:function(e){var n=W.findIndex((function(n){return n.client_surname+" "+n.client_name===e.target.value}));-1!==n&&L(T({},H,{client:e.target.value,client_id:W[n].id}))},variant:"outlined",children:W.map((function(e){return(0,i.jsx)(x.Z,{value:e.client_surname+" "+e.client_name,children:e.client_surname+" "+e.client_name},e.client_name)}))})})]}),(0,i.jsx)(m.ZP,{item:!0,xs:12,md:12,style:{marginTop:10},children:(0,i.jsxs)(j.Z,{children:[(0,i.jsx)(w.Z,{title:E("cars_damage_photo")}),(0,i.jsxs)(b.Z,{children:[(0,i.jsx)("div",{style:{width:"100%",height:"100%"},onClick:function(){U.current.click()},children:(0,i.jsx)("img",{alt:"",src:(null===H||void 0===H?void 0:H.damage_image)||"https://www.aluminati.net/wp-content/uploads/2016/03/img-placeholder.png",style:{width:"100%",height:"100%",minHeight:150,objectFit:"cover"}})}),(0,i.jsx)("input",{type:"file",onChange:function(e){return z(e.target.files[0])},style:{width:.1,height:.1,opacity:0,pointerEvents:"none"},ref:U})]})]})})]})]})}}},function(e){e.O(0,[9990,5360,6827,3970,5464,6668,2945,8991,7104,8722,9576,9792,9774,2888,179],(function(){return n=52608,e(e.s=n);var n}));var n=e.O();_N_E=n}]);